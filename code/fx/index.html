<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <title>Foreign Exchange Mobile Web App | mariosanchez.org</title>
    <meta name="author" content="Mario Sanchez Carrion">
    <meta name="description" content="Mobile-friendly FX watcher" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    <script src="/js/theme.js"></script>

    <link rel="stylesheet" href="/css/all.css">
    <link rel="stylesheet" href="/css/minimal.css">
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel='stylesheet' href='//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.css'>
  </head>

  <body>
    <div class="header"></div>
    <a href="/">
      <div class="avatar">
        <a style="cursor:pointer;">
        <span class="icon" id="toggle-switch"> <i class="fas fa-sun fa-2x hd"></i></span><br />
        </a>
      </div>
    </a>
    <div class="centered logo">
      <a href="/"><img src="/img/mario-pix-dk.png" width="150" /></a>
    </div>
      <nav>
        <ul>
          <li>
            <a href="/coding/">code</a>
          </li>
          <li>
            <a href="/uses/">stack</a>
          </li>
          <li>
            <a href="/photos/">photos</a>
          </li>
        </ul>
      </nav>
    <div class="container">


<main id="main">
  <h1>Foreign Exchange Mobile Web App</h1>
  <p class="description">Mobile-friendly FX watcher</p>  
    <article id="content">
    <p><strong>Made with</strong>: <i class="fab fa-js"></i> JavaScript</p>
<p><a href="https://github.com/mariobox/fx-watcher">Source Files</a> | <a href="https://mariobox.github.io/fx-watcher">Demo</a></p>
<p><strong>Update</strong>: The API I was using for this project is not in business any more, so the demo will not work. I am looking for a new API to adapt this project and make it work again.</p>
<hr class="art" />
<p>We will create a mobile web app that will display the current exchange of a basket of currencies versus the US dollar. Besides the current rate we also want to display the <strong>YTD % devaluation</strong> (or revaluation) for each of the currencies.</p>
<p>I decided to implement this project because I work in international marketing, and devaluation is always an important variable to follow when analyzing business results. I wanted a simple, fast way to browse through the most important currencies for my business, and I wanted it to look good on my phone.</p>
<p>This is how the app looks on my phone:</p>
<p><img src="/img/fx.PNG" class="gallery medium" /></p>
<p>The <strong>HTML</strong> is fairly straightforward. Since we wanted a nice styling that worked well in mobile we decided to use of <a href="https://getbootstrap.com">Bootstrap</a>, by including it in the <code>&lt;head&gt;</code> of our home page:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">...

<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css&#34;</span><span class="p">&gt;</span> 

...

</code></pre></div><p>Another important piece of our home page is a <code>div</code> with the ID of <code>root</code>, where we will place the content generated by our <code>app</code> (i.e. the currency table).</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">...

<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;row&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#39;root&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

...

</code></pre></div><p>The JavaScript is a little bit more challenging. We used the <code>fetch()</code> method to get info from an external <a href="https://worldtradingdata.com">API</a> that provides the exchange rate information. We need two different API calls: one for today&rsquo;s exchange rate, and another one for the rate on December 31 of the previous year. We need <em>both</em> rates in order to calculate the <abbr title="Year to Date">YTD</abbr> devaluation percentage:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">url1</span> <span class="o">=</span> 
    <span class="sb">`https://api.worldtradingdata.com/api/v1/forex?base=USD&amp;api_token=onH6cZpUDVXChT9cbQ6jHuCkgoWPjCmBNRz0Sy5hs4icLbqds5ta1VF0pDpl`</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">url2</span> <span class="o">=</span>
    <span class="sb">`https://api.worldtradingdata.com/api/v1/forex_single_day?base=USD&amp;date=</span><span class="si">${</span><span class="nx">formattedLastYear</span><span class="si">}</span><span class="sb">&amp;api_token=onH6cZpUDVXChT9cbQ6jHuCkgoWPjCmBNRz0Sy5hs4icLbqds5ta1VF0pDpl`</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">fetchExchange</span> <span class="o">=</span> <span class="nx">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url1</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">rates</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
    
    <span class="kr">const</span> <span class="nx">resly</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url2</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">ratesly</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">resly</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>

<span class="c1">// some other code follows...
</span><span class="c1"></span><span class="p">}</span>
</code></pre></div><p>Notice we&rsquo;re using <code>async</code> to indicate an asynchronous function, and <code>await</code> to tell the program to wait until it receives <em>all</em> the information from the API before carrying on with the program.</p>
<p>We also created two arrays, one containing the <strong>currency abbreviations</strong> we want and another one containing <strong>country flags</strong> that we use in our HTML to make it look nice. Note that the currency symbols have to match exactly the way the API refers to them, or no information will be sent back from their server. We also created two empty array to place the exchange rate values at the current date, and at the last day of the previous year:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">let</span> <span class="nx">currencies</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;ARS&#34;</span><span class="p">,</span> <span class="s2">&#34;AUD&#34;</span><span class="p">,</span> <span class="s2">&#34;BRL&#34;</span><span class="p">,</span> <span class="s2">&#34;CAD&#34;</span><span class="p">,</span> <span class="s2">&#34;CLP&#34;</span><span class="p">,</span> <span class="s2">&#34;CNY&#34;</span><span class="p">,</span> <span class="s2">&#34;COP&#34;</span><span class="p">,</span> <span class="s2">&#34;EUR&#34;</span><span class="p">,</span> <span class="s2">&#34;GBP&#34;</span><span class="p">,</span> <span class="s2">&#34;INR&#34;</span><span class="p">,</span> <span class="s2">&#34;JPY&#34;</span><span class="p">,</span> <span class="s2">&#34;MXN&#34;</span><span class="p">,</span> <span class="s2">&#34;PEN&#34;</span><span class="p">,</span> <span class="s2">&#34;RUB&#34;</span><span class="p">];</span>
<span class="kd">let</span> <span class="nx">flags</span> <span class="o">=</span><span class="p">[</span><span class="s2">&#34;img/arg.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/aus.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/bra.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/can.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/chi.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/chn.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/col.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/eur.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/gbr.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/ind.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/jap.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/mex.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/per.png&#34;</span><span class="p">,</span> <span class="s2">&#34;img/rus.png&#34;</span><span class="p">];</span>
<span class="kd">let</span> <span class="nx">exchanges</span> <span class="o">=</span> <span class="p">[];</span>
<span class="kd">let</span> <span class="nx">exchangesly</span> <span class="o">=</span> <span class="p">[];</span>
</code></pre></div><p>Once we receive the information from the API we have to <strong>parse it to a float</strong>-since the info coming back from an API is always a string. Then, we use the <code>push()</code> method to add the currency values to their respective arrays:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// Update our arrays with exchange rate data return from fetch calls
</span><span class="c1"></span><span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">currencies</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">exchanges</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">rates</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">currencies</span><span class="p">[</span><span class="nx">i</span><span class="p">]]))</span>
<span class="p">}</span>

<span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">currencies</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">exchangesly</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">ratesly</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">currencies</span><span class="p">[</span><span class="nx">i</span><span class="p">]]))</span>
    <span class="p">}</span> 
</code></pre></div><p>Once we have that information, a <code>for</code> loop iterates over our <strong>flags</strong>, <strong>currencies</strong> and <strong>exchange</strong> rate arrays and builds the HTML container that we will then pass to the <code>&lt;div&gt;</code> with the ID of <code>root</code> in our <code>index.html</code> file:</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh"><span class="k">for</span> <span class="o">(</span><span class="nb">let</span> <span class="nv">i</span> <span class="o">=</span> 0<span class="p">;</span> i &lt; l<span class="p">;</span> i++<span class="o">)</span> <span class="o">{</span>
    exchanges<span class="o">[</span>i<span class="o">]</span> - exchangesly<span class="o">[</span>i<span class="o">]</span> &lt; <span class="m">0</span> ? <span class="nv">bkchangely</span> <span class="o">=</span> <span class="s2">&#34;#00CC00&#34;</span>: <span class="nv">bkchangely</span> <span class="o">=</span> <span class="s2">&#34;#FF0000&#34;</span><span class="p">;</span>
    
    <span class="nv">html</span> <span class="o">+=</span> <span class="sb">`</span>&lt;tr&gt;
              &lt;th <span class="nv">scope</span><span class="o">=</span><span class="s2">&#34;row&#34;</span>&gt;&lt;img <span class="nv">src</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">flags</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&#34;25px&#34;</span>&lt;/th&gt;
              &lt;td&gt;&lt;strong&gt;<span class="si">${</span><span class="nv">currencies</span><span class="p">[i]</span><span class="si">}</span>&lt;/strong&gt;&lt;/td&gt;
              &lt;td&gt;&lt;strong&gt;<span class="si">${</span><span class="nv">exchanges</span><span class="p">[i].toFixed(2)</span><span class="si">}</span>&lt;/strong&gt;&lt;/td&gt;
              &lt;td&gt;&lt;p <span class="nv">class</span><span class="o">=</span><span class="s2">&#34;change&#34;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&#34;background-color:</span><span class="si">${</span><span class="nv">bkchangely</span><span class="si">}</span><span class="s2">&#34;</span>&gt;&lt;strong&gt;<span class="si">${</span><span class="p">(((exchanges[i] - exchangesly[i])/exchanges[i])*100*(-1)).toFixed(2)</span><span class="si">}</span>%&lt;/strong&gt;&lt;/p&gt;&lt;/td&gt;
            &lt;/tr&gt;<span class="sb">`</span>
<span class="o">}</span> 

// Build our table
<span class="nv">html</span> <span class="o">=</span> <span class="sb">`</span>&lt;table <span class="nv">class</span><span class="o">=</span><span class="s2">&#34;table table-dark&#34;</span>&gt;&lt;tbody&gt;<span class="si">${</span><span class="nv">html</span><span class="si">}</span>&lt;/tbody&gt;&lt;/table&gt;<span class="sb">`</span><span class="p">;</span>

// Display our table
document.getElementById<span class="o">(</span><span class="s2">&#34;root&#34;</span><span class="o">)</span>.innerHTML <span class="o">=</span> html<span class="p">;</span>
</code></pre></div><p>Finally, we call our <code>fetchExchange()</code> function to set the program in motion and deliver our table to the browser.</p>
<p>All this will make more sense when you review the full <a href="https://github.com/mariobox/fx-watcher">source files</a> available in Github.</p>

    </article>  
</main>
<p class="date">Last updated: Feb 20, 2020</p>

<br /><br />
  <p class="centered">
  <span class="small">  
    <a href="https://www.linkedin.com/in/mariobox/" title="Linkedin"><i class="fab ft fa-linkedin fa-lg"></i></a>
    <a href="https://github.com/mariobox" title="Github"><i class="fab ft fa-github fa-lg"></i></a>
    <a href="https://instagram.com/_mario.codes" title="Github"><i class="fab ft fa-instagram fa-lg"></i></a>
    <a href="mailto:mario@mariosanchez.org" title="Email"><i class="fas ft fa-envelope fa-lg"></i></a>
  </span>
  </p>
  <p class="centered small">
    &copy; 2022 Mario Sanchez Carrion
  </p>
</div>
</body>
</html>


